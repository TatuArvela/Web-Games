<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<meta http-equiv='X-UA-Compatible' content='ie=edge'>
<title></title>
</head>

<body>
<canvas id='ðŸŽ¦'/>
<script>
/* ---------------------------------------------------------------- */

              document.title = 'MYSTIFY.SCR'

                 const scale =  2
               const canvas  =  document.getElementById('ðŸŽ¦')
                    const c  =  canvas.getContext('2d')
               canvas.width  =  1024*scale
              canvas.height  =  768*scale

        document.body.style  = 'background: black'
               canvas.style  = 'margin: auto;\
                                left: 0;\
                                right: 0;\
                                position: absolute;\
                                top: 0;\
                                bottom: 0;\
                                border: 2px solid white;\
                                transform: scale(0.5);\
                                image-rendering: pixelated;\
                                image-rendering: crisp-edges'

/* ---------------------------------------------------------------- */

  function clear() {
    c.fillStyle = 'black'
    c.fillRect(0, 0, canvas.width, canvas.height)
  }

  function drawLineSet(startCoords, endCoords, startSpacing, endSpacing) {
    for (let i = 0; i < 5; i++) {
      c.beginPath()
      c.moveTo(
        (startCoords[0]) * scale,
        (startCoords[1] + startSpacing * i) * scale
      )
      c.lineTo(
        (endCoords[0]) * scale,
        (endCoords[1] + endSpacing * i) * scale
      )
      c.closePath();
      c.stroke();
    }
  }

  function drawShape(color, coords, spacings) {
    c.strokeStyle = color
    drawLineSet(coords[0], coords[1], spacings[0], spacings[1])
    drawLineSet(coords[1], coords[2], spacings[1], spacings[2])
    drawLineSet(coords[2], coords[3], spacings[2], spacings[3])
    drawLineSet(coords[3], coords[0], spacings[3], spacings[0])
  }

  function pixelate() {
    let imageData = c.getImageData(0, 0, canvas.width, canvas.height);    
    for (i = 0; i != imageData.data.length; i ++) {
      imageData.data[i] = (imageData.data[i] >> 1) * 0xFF
    }
    c.putImageData (imageData, 0, 0);
  }

  function draw() {
    clear()
    drawShape(color1, coords1, spacings1)
    drawShape(color2, coords2, spacings2)
    pixelate()
  }

  function update() {
    draw()
  }

  let color1 = 'magenta'

  let coords1 = [
    [30, 30],
    [150, 30],
    [400, 300],
    [80, 240]
  ]

  let spacings1 = [8, 10, 2, 4]

  let color2 = 'cyan'

  let coords2 = [
    [60, 70],
    [500, 230],
    [600, 90],
    [400, 40]
  ]

  let spacings2 = [16, 6, 7, 11]

  setInterval(update, 1000 / 10);

// TODO: Shape corners have motion vectors (speedX, speedY)
// TODO: Shape corners bounce on canvas edges
// TODO: Shapes cycle web-safe colors

</script>
</body>

</html>